---
import type { GetStaticPaths } from "astro";
import { getCollection, getEntry } from "astro:content";
import PageLayout from "../../../layouts/PageLayout.astro";
import { Debug } from "astro:components";
import ContentRender from "@/components/ContentRender/ContentRender.astro";

const BASE_URL = import.meta.env.BASE_URL;

export const getStaticPaths = (async () => {
  const pageCollections = await getCollection("work");
  return pageCollections
    .map((p) => {
      const [lang, ...slug] = p.id.split("/");
      return {
        params: {
          slug: slug.join("/"),
        },
        props: {
          id: p.id,
          lang: lang,
          collection: p.collection,
        },
      };
    })
    .filter((v) => v.props.lang === "zh-CN");
}) satisfies GetStaticPaths;

const props = Astro.props;
const page = await getEntry("work", props.id);
---

<PageLayout title="Null Studio Gallery">
  <Debug {props} />
  <Debug {page} />
  <ContentRender contents={page.data.contents} />
</PageLayout>
